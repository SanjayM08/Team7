Partial Class admin Inherits System.Web.UI.Page Public ref, can_name, gender, qual, job_title As String Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load LinkButton1.Attributes.Add("onmouseover", "this.style.color='green'") LinkButton1.Attributes.Add("onmouseout","this.style.color='Blue'") LinkButton2.Attributes.Add("onmouseover", "this.style.color='green'") LinkButton2.Attributes.Add("onmouseout", "this.style.color='Blue'") LinkButton3.Attributes.Add("onmouseover", "this.style.color='green'") LinkButton3.Attributes.Add("onmouseout", "this.style.color='Blue'") LinkButton4.Attributes.Add("onmouseover", "this.style.color='green'") LinkButton4.Attributes.Add("onmouseout", "this.style.color='Blue'") LinkButton5.Attributes.Add("onmouseover", "this.style.color='green'") LinkButton5.Attributes.Add("onmouseout","this.style.color='Blue'") LinkButton6.Attributes.Add("onmouseover", "this.style.color='green'") LinkButton6.Attributes.Add("onmouseout", "this.style.color='Blue'") End Sub Protected Sub LinkButton7_Click(ByVal sender As Object, ByVal e As System.EventArgs) HandlesLinkButton7.Click ref = Session("ref")
can_name = Session("can_name")
35
gender = Session("gender") qual = Session("qual") If uname.Text = "Admin" And pswd.Text = "Admin" Then Session("log") = "Admin" Response.Redirect("default.aspx") End If If ref <> "" And can_name <> "" And gender <> "" And qual <> "" And job_title <> "" Then If uname.Text = "Test" A nd pswd.Text = "Test" Then Response.Redirect("writ_test.aspx") Session("ref") = ref Session("can_name") = can_name Session("gender") = gender Session("qual") = qual End If End If End Sub Protected Sub LinkButton8_Click(ByVal sender As Object, ByVal e As System.EventArgs) HandlesLinkButton8.Click Session("log") = "User" Response.Redirect("default.aspx") End Sub End Class Imports System.Data.SqlClient Imports System.Net.Mail Partial Class post_resume Inherits System.Web.UI.Page Dim imageByte As [Byte]() = Nothing
Dim con As New SqlConnection("server=DESKTOP- 3H4OORJ\SQLEXPRESS;database=HumanResource;user id=sa;pwd=sql;")
36
Dim com, com1, com2 As New SqlCommand Dim qry, qry1, qry2 As String Dim adp, adp1 As New SqlDataAdapter Dim ds, ds1 As New Data.DataSet Dim dr As SqlDataReaderDim s As String Dim var, var1, var2, var3, cref, cname, cno, mid, caddr, rp, ctry, sms As String Protected Sub But_sub_Click(ByVal sender As Object, ByVal e As System.EventArgs) HandlesBut_sub.Click If can_name.Text = "" Or fat_name.Text = "" Or occu.Text = "" Or gender.Text = "" Or age.Text = ""Or addr.Text = "" Or cont_no.Text = "" Or mail_id.Text = "" Or qual.Text = "" Or degree.Text = "" Or institute.Text = "" Or city.Text = "" Or yrs.Text = "" Or comp_skill.Text = "" Or hobbies.Text = "" Then cmd.Text = "Please Fill Empty Fields"s = 0 Else s = 1 End If Dim StrImageContentType As String If FileUpload1.HasFile And FileUpload1.PostedFile IsNot Nothing Then Dim file As HttpPostedFile = FileUpload1.PostedFile imageByte = New [Byte](file.ContentLength - 1) {} StrImageContentType = FileUpload1.PostedFile.ContentType file.InputStream.Read(imageByte, 0, file.ContentLength) If StrImageContentType = "application/msword" And s = 1 Then Dim SqlCommand = New SqlCommand("insert into post_res(can_name,fat_name,occu,gender,age,addr,cont_no,mail_id,qual
,degree,institution,city,yrs,job_title,lang,comp_skill,hobbies,resume)valu
37
es(@can_name,@fat_name,@occu,@gender,@age,@addr,@cont_no,@ mail_id,@qual,@degree,@institution,@city,@yrs,@job_title,@lang,@c omp_skill,@hobbies,@resume) ", con) con.Open() SqlCommand.Parameters.AddWithValue("@can_name", can_name.Text.Trim()) SqlCommand.Parameters.AddWithValue("@fat_name", fat_name.Text.Trim()) SqlCommand.Parameters.AddWithValue("@occu", occu.Text.Trim()) SqlCommand.Parameters.AddWithValue("@gender", gender.Text.Trim()) SqlCommand.Parameters.AddWithValue("@age", age.Text.Trim()) SqlCommand.Parameters.AddWithValue("@addr",
cont_no.Text.Trim()) SqlCommand.Parameters.AddWithValue("@mail_id", mail_id.Text.Trim()) SqlCommand.Parameters.AddWithValue("@qual", qual.Text.Trim()) SqlCommand.Parameters.AddWithValue("@degree", degree.Text.Trim()) SqlCommand.Parameters.AddWithValue("@institution", institute.Text.Trim()) SqlCommand.Parameters.AddWithValue("@city", city.Text.Trim()) SqlCommand.Parameters.AddWithValue("@yrs", yrs.Text.Trim()) SqlCommand.Parameters.AddWithValue("@job_title", job_title.Text.Trim()) SqlCommand.Parameters.AddWithValue("@lang", lang.Text.Trim()) SqlCommand.Parameters.AddWithValue("@comp_skill", comp_skill.Text.Trim()) SqlCommand.Parameters.AddWithValue("@hobbies", hobbies.Text.Trim())
38
SqlCommand.Parameters.AddWithValue("@resume", imageByte) SqlCommand.ExecuteScalar() con.Close() cmd.Text = "Your Resume Posted Successfully" Try qry1 = "select comp_ref,job_title,work_hrs,age from job_prof where qual='" + qual.Text + "'and exp='" + yrs.Text + "' and job_title='" + job_title.Text + "'" com1 = New SqlCommand(qry1, con) adp1 = New SqlDataAdapter(com1) ds1 = New Data.DataSet adp1.Fill(ds1, "job_prof") cref = ds1.Tables("job_prof").Rows(0)(0) var = ds1.Tables("job_prof").Rows(0)(1) var1 = ds1.Tables("job_prof").Rows(0)(2) var2 = ds1.Tables("job_prof").Rows(0)(3) qry = "select comp_name,comp_addr,cont_no,mail_id,country,res_per from comp_prof wherecomp_ref='" + cref + "'" com = New SqlCommand(qry, con) adp = New SqlDataAdapter(com) ds = New Data.DataSet adp.Fill(ds, "comp_prof") cname = ds.Tables("comp_prof").Rows(0)(0) caddr = ds.Tables("comp_prof").Rows(0)(1) cno = ds.Tables("comp_prof").Rows(0)(2) Mid = ds.Tables("comp_prof").Rows(0)(3) ctry = ds.Tables("comp_prof").Rows(0)(4) rp
= ds.Tables("comp_prof").Rows(0)(5)
39
Try
Dim message As MailMessage = New MailMessage() message.From = New MailAddress("testcrisp@gmail.com")
message.To.Add("testcrisp@gmail.com") message.Body = cname & vbCrLf & caddr & vbCrLf & cno & vbCrLf & mid & "," & vbCrLf & ctry & "," & vbCrLf & "Your Resume was Verified by Management. Call for Intreview dt is01.01.2010." & vbCrLf & "Designation:" & var & vbCrLf & "Thank You" & vbCrLf & rp sms = cname & vbCrLf & caddr & vbCrLf & cno & vbCrLf & mid & "," & vbCrLf & ctry& "," & vbCrLf & "Your Resume was Verified by Management. Call for Intreview dt is 01.01.2010. " & vbCrLf & "Designation:" & var & vbCrLf & "Thank You" & vbCrLf & rp message.Subject = "Intreview Call" message.IsBodyHtml = True Dim client As SmtpClient = New SmtpClient() '587 client.Host = "smtp.gmail.com" client.Port = 587 client.Credentials = New
System.Net.NetworkCredential("testcrisp@gmail.com","9095118988") client.EnableSsl = True client.Send(message) qry2 = "update post_res set status='" + "Mail Sended" + "' where can_name='" + can_name.Text + "' and fat_name='" + fat_name.Text + "' and mail_id='" + mail_id.Text + "'" com2 = New SqlCommand(qry2, con) con.Open() com2.ExecuteScalar() con.Close()
cmd.Text = "Mail Send" 'System.Diagnostics.Pro 'Sending SMS Catch ex As Exception MsgBox
40
(ex.Message) End Try Catch ex As Exception qry2 = "update post_res set status='" + "Mail Not Sended" + "' where can_name='" + can_name.Text + "' and fat_name='" + fat_name.Text + "' and mail_id='" + mail_id.Text + "'" com2 = New SqlCommand(qry2, con) con.Open() com2.ExecuteScalar() con.Close() End Try
